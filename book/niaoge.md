---------------------------------------------------------------------------
	 File Name: niaoge.md
	 Author: Fan Chongru
	 Mail: chongrufan123@gmail.com
	 Created Time: 2021年03月02日 星期二 19时38分34秒
     notes: 鸟哥的linux私房菜第四版
 --------------------------------------------------------------------------
# 鸟哥linux私房菜

<!-- vim-markdown-toc Marked -->

* [第0章, 计算机概论](#第0章,-计算机概论)
    * [电脑:辅助人脑的好工具](#电脑:辅助人脑的好工具)
        * [计算机硬件的五大单元](#计算机硬件的五大单元)
        * [一切设计的起点:CPU架构](#一切设计的起点:cpu架构)
        * [其他单元的设备](#其他单元的设备)
        * [电脑按用途分类](#电脑按用途分类)
        * [电脑上常用的计算单位(容量, 速度等)](#电脑上常用的计算单位(容量,-速度等))
* [第一章, linux是什么与如何学习](#第一章,-linux是什么与如何学习)
    * [linux是什么](#linux是什么)
        * [linux distributions](#linux-distributions)
* [第二章, 主机规划与磁盘分区](#第二章,-主机规划与磁盘分区)
    * [主机规划](#主机规划)
        * [各硬件设备在linux中的文件名](#各硬件设备在linux中的文件名)
    * [磁盘分区](#磁盘分区)
* [第四章, 首次登陆与线上求助](#第四章,-首次登陆与线上求助)
        * [基础指令操作](#基础指令操作)
        * [重要的几个热键](#重要的几个热键)
        * [man page](#man-page)
    * [正确的关机方法](#正确的关机方法)
* [第五章, linux的文件权限和目录配置](#第五章,-linux的文件权限和目录配置)
    * [使用者与群组](#使用者与群组)
    * [linux文件权限概念](#linux文件权限概念)
        * [如何改变文件属性与权限](#如何改变文件属性与权限)
        * [目录和文件的权限的意义](#目录和文件的权限的意义)
        * [linux文件种类和拓展名](#linux文件种类和拓展名)
    * [linux目录配置](#linux目录配置)
* [第六章, linux文件与目录管理](#第六章,-linux文件与目录管理)
    * [目录与路径](#目录与路径)
    * [文件与目录管理](#文件与目录管理)
        * [取得路径的文件名与目录名称](#取得路径的文件名与目录名称)
    * [文件内容查阅](#文件内容查阅)
    * [文件和目录的默认权限和隐藏权限](#文件和目录的默认权限和隐藏权限)
    * [观察文件类型:file](#观察文件类型:file)
    * [指令与文件的搜寻](#指令与文件的搜寻)
* [linux磁盘与文件系统管理](#linux磁盘与文件系统管理)
    * [认识linux文件系统](#认识linux文件系统)
        * [磁盘组成和分区](#磁盘组成和分区)

<!-- vim-markdown-toc -->

## 第0章, 计算机概论

### 电脑:辅助人脑的好工具

#### 计算机硬件的五大单元
电脑由五大单元组成:输入单元, 输出单元, CPU内部控制单元, 算数逻辑单元, 内存

#### 一切设计的起点:CPU架构 
-   精简指令集(RISC)  
    比较精简, 单个指令完成的事情很少, 执行时间短, 执行性能佳
    >   甲骨文公司的SPARC系列  
        IBM公司的PowerPC系列  
        安谋公司的ARM系列
-   复杂指令集(CISC)  
    指令多且复杂, 运行时间长, 但是单个指令可以解决的事情多
    >   AMD, Intel, VIA

#### 其他单元的设备
其他单元的重要设备主要有
-   系统单元:包括CPU与内存还有主板相关元件
-   存储单元:包括内存和辅助内存(储存设备)
-   输入输出单元:屏幕等

#### 电脑按用途分类
1.  超级计算机:运行速度最快的电脑
2.  大型计算机:用来处理大量数据与复杂的运算
3.  迷你电脑:用来进行一般的工作
4.  工作站:针对特殊用途设计的电脑
5.  微电脑:个人电脑, 体积小, 价格低

#### 电脑上常用的计算单位(容量, 速度等)
-   容量单位
    >   1byte = 8bits
|进位制|Kilo|Mega|Giga|Tera|Peta|Exa|Zetta|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|二进制|1024|1024|1024|1024|1024|1024|1024|
|十进制|1000|1000|1000|1000|1000|1000|1000|

存储用二进制  
速度单位用十进制

## 第一章, linux是什么与如何学习

### linux是什么
linux是一套操作系统

每种操作系统都是在他专门的硬件机器上运行的, 但是linux由于是开源的,
所以他的程序码可以被修改成适合在各种硬件运行, 所以linux具有可移植性  
由于linux的架构稳定而强大, 可以在个人计算机上跑, 所以很多软件开发者将工作心血转移到其中, 有很多应用软件

#### linux distributions
一些常见的linux distributions
| |RPM软件管理|DPKG软件管理|其他未分类|
|:---|:---|:---|
|商业公司|RHEL, SuSE(Micro Focus)|Ubuntu| |
|社群|Fedora, CentOS, OpenSuSE|Debian, B2D|Gentoo|

## 第二章, 主机规划与磁盘分区

### 主机规划

#### 各硬件设备在linux中的文件名
在Linux中几乎所有的硬件设备都会在/dev这个目录中
|设备|设备在/dev中的文件名|
|:----|:----|
|SCSI/SATA/USB硬盘|sd[a-d]|
|USB闪存盘|sd[a-p]|
|Virtl/O界面|vd[a-p]|
|软盘机|fd[0-7]|
|打印机|lp\[0-2](25针打印机) ./usb/lp\[0-15](USB接口)|
|鼠标|./input/mouse\[0-15](通用) psaux(PS/2界面) mouse(当前鼠标)|
|CDROM/DVDROM|scd\[0-1](通用) st0(SATA/SCSI界面) tape(当前磁带)|
|IDE磁盘机|hd\[a-d](旧式系统才有|

### 磁盘分区

## 第四章, 首次登陆与线上求助

#### 基础指令操作
-   显示日期和时间:date  
-   显示日历:cal  
-   计算器:bc

#### 重要的几个热键
```
<c-d>   键盘输入结束
<shift-{[page-up], [page-down]} 上下翻页
```

#### man page
-   NAME    这个指令的完整全名
-   SYNOPSIS    这个指令的基本语法
-   DESCRIPTION 详细说明刚刚语法谈到的选项和参数的用法
-   ENVIRONMENT 与这个指令有关的环境参数说明
-   EXAMPLES    可用的范本
-   DATE STRING 格式说明
-   AUTHOR      作者
-   COPERIGHT   著作权说明
-   SEE ALSO    其他相关说明

第一行括号里面数字的意义
|代号|代表内容|
|:---|:---|
|***1***|使用者在shell中可以操作的指令或可执行文件|
|2|系统核心可以调用的函数与工具|
|3|一些常用的函数或库|
|4|设备文件的说明, 一般在\dev下|
|***5***|配置文件或某些文件的格式|
|6|games|
|7|惯例和协定|
|***8***|系统管理员可用的管理指令|
|9|和kernel有关的文件|

### 正确的关机方法
```
who     查看当前谁在线
netstat -a  查看网络连线状态
ps -aix     背景执行的程序
sync    将数据同步到硬盘
shutdown    关机
reboot, halt, poweroff  重新开机, 关机
```

## 第五章, linux的文件权限和目录配置

### 使用者与群组
1.  文件拥有者(user)
2.  群组(group):每个群组中有若干组员, 群组中的文件可以由所有该组的组员共享, 其他组的成员无法共享
3.  其他人(others)

一般情况下, 所有系统账号和使用者还有root的信息是记录在/etc/passwd中的  
个人密码是记录在/etc/shadow文件中  
所有的群组名称记录在/etc/group中

### linux文件权限概念
当查看文件详细信息时, 查看到的属性依次是
**|权限|链接|拥有者|群组|文件大小|修改日期|文件名|**
-   权限  
    第一个字符代表文件类型
    |选项|类型|
    |:---:|:---:|
    |d|目录|
    |-|文件|
    |l|链接文件|
    |b|可存储的周边文件|
    |c|序列设备文件|

    接下来的字符中, 三个为一组, r:可读, w:可写, x:可执行  
    第一组是文件拥有者可具备的权限  
    第二组是群组的权限  
    第三组是其他人的权限  
-   第二栏表示有多少文件名链接到此节点
-   第三栏表示这个文件拥有者账号
-   第四栏表示文件所属群组
-   第五栏表示容量大小
-   第六栏表示修改日期
-   第七组是文件名

>   root是不受文件权限限制的

#### 如何改变文件属性与权限
-   chgrp:改变文件所属的群组  
-   chown:改变文件拥有者  
-   chmod:改变文件的权限
```
chgrp 选项 群组名 dirname/filename
选项:
-R  递回改变
```
```
chown 选项 账号名[:群组名} 文件/目录名
选项
-R  递回改变
```
```
chmod 选项 xyz 文件/目录名
选项:
-R  递回改变
xyz:
r:4, w:2, x:1
```

#### 目录和文件的权限的意义
目录:  
r:表示拥有读取这个目录下的文件名称的权力
w:表示拥有改变这个目录的结构清单的权力
x:表示拥有进入这个目录的权力

#### linux文件种类和拓展名
1.  文件种类
    -   正规文件:  
        -   纯文本文件:可以直接读取的文件  
        -   二进制文件:可以执行的文件
        -   数据格式文件:某些储存数据的特定格式的文件
    -   目录
    -   链接文件
    -   设备与设备文件:
        -   区块设备文件:可以存储数据设备的文件
        -   字符设备文件:一次性读取的设备的文件, 如键盘鼠标等
    -   数据接口文件:被用在网络上用来数据承接
    -   数据传送文件:
2.  文件拓展名
拓展名对于linux来说没有什么意义, 旨在让用户可以区分
    -   *.sh:脚本和批处理文件
    -   Z, .tar, .tar.gz, .zip, *.tgz:经打包的压缩文件
    -   .html, .php:网页相关文件

### linux目录配置
linux目录配置的依据是FHS标准(Filesystem Hierarchy Standard)
| |可分享的|不可分享的|
|:---:|:---:|:---:|
|不变的|/usr(软件放置处)|/etc(配置文件)|
| |/opt(第三方协力软件)|/boot(开机与核心文件)|
|可变动的|/var/mail(使用者邮件信箱)|/var/run(程序相关)|
| |/var/spool/news(新闻群组)|/var/lock(程序相关)|

-   根目录的意义和内容  
    根目录下应该有这些文件存在  
    |目录|应放置文件内容|
    |:---:|:----|
    |FHS要求必须存在的目录| |
    |/bin|放置一些可执行文件, 主要是指令|
    |/boot|放置开机后会使用到的文件|
    |/dev|放置连接的一些设备|
    |/etc|放置几乎所有的配置文件|
    |/lib|放置开机时会用到的函数库还有/bin和/sbin指令中会调用的函数库|
    |/media|放置可移除的设备|
    |/mnt|暂时挂载某个设备|
    |/opt|第三方协力软件存放的目录|
    |/run|存放开机后会产生的各项信息|
    |/sbin|开机过程中所需要的命令, 包括开机, 修复, 还原系统等|
    |/srv|一些网络服务启动后, 这些服务所需要取用的数据目录|
    |/tmp|让一般使用者或正在执行的程序暂时放置文件的地方, 任何人都可以存取, FHS建议开机时将这个目录下的数据都删除|
    |FHS建议可以存在的目录| |
    |/home|系统默认使用者的文件夹|
    |/lib\<qual>|存放与/lib不同的格式的二进制函数库|
    |/root|root的主文件夹|
    |一些其他的目录| |
    |/lost+found|当文件系统发生错误时, 将一些遗失的片段放在这个里面|
    |/proc|虚拟文件系统, 放置的数据都是在内存当中|
    |/sys|虚拟的文件系统, 主要记录核心和系统硬件信息相关的信息|

-   /usr的意义与内容  
    Unix Software Resource的缩写, 也就是Unix操作系统软件资源, 所有软件数据都应该在该目录的次目录有序排放  
    /usr的次目录建议有下面这些  
    |目录|应放置文件内容|
    |:---:|:----|
    |FHS要求必须存在的目录| |
    |./bin|所有一般用户可以使用的指令, 另外此目录下不应该有子目录|
    |./lib|与/lib功能相似, /lib链接到此目录|
    |./local|系统管理员在本机自行安装的软件建议安装在此目录|
    |./sbin|非系统正常运行所需要的系统指令|
    |./share|主要放置只读架构的数据文件, 也包括共享文件|
    |FHS建议可以存在的目录| |
    |./games|游戏相关的数据放置处|
    |./include|程序语言header和include放置处|
    |./libexec|某些不被一般使用者惯用的可执行文件或脚本|
    |./src|一般源代码|
    |./lib\<qual>/|与lib\<qual>功能相同, 后者链接到此|

-   /var的意义与内容
    主要针对常态化变动的文件, 包括高速缓存, 登陆文件以及某些软件运行产生的文件等
    |目录|应放置文件内容|
    |:---:|:----|
    |FHS要求必须存在的目录| |
    |./cache|应用程序本身运行过程会产生的一些暂存盘|
    |./lib|程序本身执行的过程中, 需要用到的数据文件放置的目录|
    |**./log**|登录文件放置的目录, 里面有重要的信息|
    |./lock|确保该设备只能给单一软件使用|
    |./mail|放置个人邮件信箱|
    |./run|某些程序或服务启动后, 会将他们的PID放置在此目录|
    |./spool|放一些伫列数据(排队等待其他程序使用的数据), 数据被使用后删除|

## 第六章, linux文件与目录管理

### 目录与路径

-   一些特殊的目录
    ```
    .   此目录
    ..  上一层目录
    -   前一个工作目录
    ~   目前使用者身份所在的主文件夹
    ~account    account使用者的主文件夹
    ```
-   一些目录的命令  
    cd  跳转
    pwd 打印当前所在目录
    mkdir -p    递回创建目录
    rmdir -p    删除空目录

### 文件与目录管理

#### 取得路径的文件名与目录名称
```
basename    取得最后的文件名或目录名
dirname     取得目录名
```

### 文件内容查阅
1.  直接检视文件内容
    -   cat
        ```
        cat [-AbEnTv]
        选项:
        -A:列出特殊字符
        -b:列出非空白行的行号
        -E:将结尾换行符显示
        -n:列出所有行行号
        -T:将tab显示
        -v:列出看不见的特殊字符
        ```
    -   tac
        反向显示
    -   nl:添加行号打印
    -   more:一页一页翻动  
        -   空白键:向下翻一页
        -   Enter:向下翻一行
        -   /str:搜索
        -   :f显示文件名和当前行数
        -   q:离开
        -   b:往回翻
    -   less:一页一页翻动
2.  数据获取
    -   head:取出前面几行
        ```
        head [-n number] 文件
        显示前number行, 默认10行
        ```
    -   tail:取出后面几行
        ```
        tail [-n number] 文件
        ```
3.  非纯文本文件
    -   od
        ```
        od [-t TYPE] 文件
        TYPE:
        a:默认字符输出
        c:ascll输出
        d[size]:十进制输出
        f[size]:浮点数输出
        o[size]:八进制输出
        x[size]:十六进制输出
        ```

### 文件和目录的默认权限和隐藏权限
-   文件默认权限:umask  
    umask指的是默认剪掉的权限, 后三个数字是user, group, others  
    如0022, 指的就是rwxr-xr-x  
    也可以加-S选项看详细的值  
    如果要设置umask, 直接在后面输入三位数字就好
    ```
    umask 002
    ```

-   文件隐藏属性
    -   chattr(设置文件隐藏属性)
        ```
        chattr [+-=][ASacdistu] 文件或目录名
        选项和参数:
        +:增加某个特殊参数
        -:移除某个特殊参数
        =:设置一定且仅有后面接的参数

        A:当有存取此文件或目录时, 存取时间atime不会被修改
        S:当进行文件修改时, 会同步写到硬盘中
        ***a:只能增加数据, 不能删除或修改数据***
        c:自动将文件压缩, 当读取时再解压缩
        d:当dump程序执行时, 不会被备份
        ***i:让一个文件不能被删除, 改名, 设置链接, 不能写入和新增数据***
        s:如果被删除, 会被永久移除硬盘
        u:如果被删除, 数据内容还在硬盘
        ```
    -   lsattr(显示文件隐藏属性)
        ```
        lsattr [-adR] 文件或目录
        选项:
        -a:将隐藏文件的属性也列出
        -d:列出目录本身而非下属文件的信息
        -R:连同子目录的数据也一并列出
        ``` 

### 观察文件类型:file
```
file 文件   //可以告诉这个文件的类型
```

### 指令与文件的搜寻

-   指令文件名的搜寻
    -   which(寻找"可执行文件")
        ```
        which [-a] command
        选项:
        -a:将所有再PATH中可以找到的指令列出, 而不是第一个
        ```
        内置函数没有办法被找到
-   文件文件名的搜寻
    -   whereis
        ```
        whereis [-bmsu] 文件或目录名
        选项:
        -l:可以列出whereis会去查询的几个主要目录
        -b:只找binary格式的文件
        -m:只能在说明文档manual路径下的文件
        -s:只找到source来源文件
        -u:搜寻不在上述三个项目当中的其他特殊文件
        ```
    -   locate/updatedb
        ```
        locate [-ir] keyword
        选项:
        -i:忽略大小写的差异
        -c:不输出文件名, 仅输出找到的文件数量
        -l:仅输出n行
        -S:输出locate所使用的数据库文件的相关信息, 包括数据库记录的文件/目录数目等
        -r:后面可以接正则表达式的显示方式
        ```
        在数据库中寻找文件, 数据库可能一段时间更新一次, 可以手动更新数据库
        ```
        updatedb
        ```
    -   find
        ```
        find [PATH] [option] [action]  
        选项和参数:
        1, 和时间有关的选项:
        -mtime n:n天之前的一天之内被修改过的文件
        -mtime +n:n天的之前被修改过的文件
        -mtime -n:n天之内被修改过的文件
        -newer file:file是一个已经存在的文件, 列出比file新的文件
        2,与使用者和群组名称有关的参数
        -uid n:数字是使用者的ID
        -gid n:群组名称的id
        -user name:使用者账号的名称
        -group name:群组名称
        -nouser:寻找文件的所有者不存在于/etc/passwd的人
        -nogroup:寻找文件的所有者不存在于/etx/group的人
        3, 与文件权限和名称有关的参数
        -name filename:搜寻文件名为filename的文件
        -size [+-]SIZE:搜寻比SIZE大[+]或小[-]的文件
        -type TYPE:搜索文件类型是TYPE的文件
        -perm mode:搜索文件权限刚好等于mode的文件
        -perm -mode:搜索文件权限囊括mode的文件
        -perm /mode:搜索文件权限包含任一mode的权限的文件
        4, 额外可进行的动作
        -exec command:-exec后接其他指令处理搜寻到的结果
        -print:将结果打印到屏幕上
        ```
## linux磁盘与文件系统管理
### 认识linux文件系统
#### 磁盘组成和分区
磁盘组成
-   圆形的盘片(记录数据)
-   机械手臂, 和在机械手臂上的磁头(读写盘片)
-   主轴马达, 可以转动盘片, 让机械手臂读写数据

盘片的物理组成
-   扇区, 最小的物理储存单位, 目前主要有521Bytes和4K两个格式
-   柱面, 扇区组成一个圆
-   扇区作为最小的分区单位
-   磁盘分区的格式
    -   MBR分区:第一个扇区最重要, 限制比较多
    -   GPT分区:较新, 限制较少, 分区数量扩充较多
-   /dev/sd[a-p][1-128] 实体磁盘的磁盘文件名
-   /dev/vd[a-d][1-128] 虚拟磁盘的磁盘文件名

-   索引式文件系统(indexed allocation)  
        一个文件系统的一些属性会存放在不同的区块
        -   superblock:记录整体信息, 包括inode/block的总量, 使用量, 剩余量以及文件系统格式与相关信息等
        -   inode:记录文件的属性, 一个文件占用一个inode, 同时记录此文件的数据所在的block的号码
        -   block:实际记录文件内容, 太大会占据多个block  
        文件找到他的inode, 然后就可以找到他的所有的block, 就可以都读取出来

-   FAT格式
        每个block号码记录在前一个block中, 然后依次读取, 类似于链条

inode table  
    inode table记录的文件数据有以下这些
    -   文件的存取模式(read/write/excute)
    -   该文件的拥有者与群组(owner/group)
    -   该文件的容量
    -   改文件创建或状态改变的时间(ctime)
    -   最近一次读取时间(atime)
    -   最近修改的时间(mtime)
    -   定义文件特性的旗帜(flag)
    -   该文件真正的指向(pointer)  
    inode的特点有这些
    -   每个inode大小固定是128Bytes
    -   每个文件仅仅占用一个inode
    -   文件系统能够创建的文件数量和inode有关
    -   读取文件要先找到inode

superblock  
    记录整个filesystem相关信息的地方, 记录的信息有
    -   block和inode的总量
    -   未使用与已使用的inode/block数量
    -   block和inode的大小(block:1, 2, 4k, inode:128Bytes或256Bytes)
    -   filesystem的挂载时间, 最近一次写入数据的时间, 最近一次检验硬盘的时间等
    -   一个valid bit数值, 若文件挂载, 则valid bit为0, 否则为1
    ```
    dumpe2fs [-bh] 
